# üé¨ TGS Animations Integration Guide

## –ß—Ç–æ —ç—Ç–æ?

TGS (Telegram Stickers) - —Ñ–æ—Ä–º–∞—Ç –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç–∏–∫–µ—Ä–æ–≤ Telegram –Ω–∞ –æ—Å–Ω–æ–≤–µ Lottie. –ú—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `@telegram-apps/tgs-player` –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∞–Ω–∏–º–∞—Ü–∏–π gift_limited_1.tgs - gift_limited_120.tgs.

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–ê–Ω–∏–º–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–µ–∑–¥–µ, –≥–¥–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–¥–∞—Ä–∫–∏:
- ‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∏ –∫–µ–π—Å–æ–≤ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
- ‚úÖ –ö–∞—Ä—É—Å–µ–ª—å –≤ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∫–µ–π—Å–∞
- ‚úÖ –°–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–Ω—ã–µ –∫–µ–π—Å—ã)
- ‚úÖ –†—É–ª–µ—Ç–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
- ‚úÖ –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- ‚úÖ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –≤—ã–∏–≥—Ä—ã—à–µ–π

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è TGS –∞–Ω–∏–º–∞—Ü–∏–π, –¥–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ `gift_number` –≤ –≤–∞—à–∏ –æ–±—ä–µ–∫—Ç—ã:

```json
{
  "id": 1,
  "name": "Premium Gift",
  "gift_number": 42,  // –ù–æ–º–µ—Ä –æ—Ç 1 –¥–æ 120
  "value": 100,
  "rarity": "legendary"
}
```

–ï—Å–ª–∏ `gift_number` —É–∫–∞–∑–∞–Ω –∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 1-120, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ TGS –∞–Ω–∏–º–∞—Ü–∏—è. –ò–Ω–∞—á–µ - –æ–±—ã—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ `image_url`.

### 3. –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

–í—Å–µ TGS —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤:
```
/static/images/gift_limited_1.tgs
/static/images/gift_limited_2.tgs
...
/static/images/gift_limited_120.tgs
```

## ‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:

1. **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –∞–Ω–∏–º–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≤–∏–¥–Ω—ã –Ω–∞ —ç–∫—Ä–∞–Ω–µ
2. **Intersection Observer** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞—É–∑–∞ –∞–Ω–∏–º–∞—Ü–∏–π –≤–Ω–µ viewport
3. **–õ–∏–º–∏—Ç –∞–Ω–∏–º–∞—Ü–∏–π** - –º–∞–∫—Å–∏–º—É–º 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–≥—Ä–∞—é—â–∏—Ö –∞–Ω–∏–º–∞—Ü–∏–π
4. **GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `will-change` –∏ `transform: translateZ(0)`
5. **–û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏** - –ø–ª–µ–µ—Ä—ã —É–Ω–∏—á—Ç–æ–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ —ç–∫—Ä–∞–Ω–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

–í `tgs-manager.js` –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å:

```javascript
this.maxVisibleAnimations = 10; // –ú–∞–∫—Å. –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π
```

## üé® –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

–ü—Ä–æ—Å—Ç–æ —É–∫–∞–∂–∏—Ç–µ `gift_number` –≤ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∞—Ä–∫–∞:

```javascript
const gift = {
    id: 1,
    name: "Rare Bird",
    gift_number: 25, // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç gift_limited_25.tgs
    value: 50
};
```

### –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```javascript
// –°–æ–∑–¥–∞–Ω–∏–µ TGS –ø–ª–µ–µ—Ä–∞
const playerId = window.tgsManager.createPlayer(
    'my-container',  // ID –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    42,              // –ù–æ–º–µ—Ä –ø–æ–¥–∞—Ä–∫–∞ (1-120)
    {
        autoplay: false,
        loop: true
    }
);

// –ó–∞–ø—É—Å–∫ –∞–Ω–∏–º–∞—Ü–∏–∏
window.tgsManager.playAnimation(playerId);

// –ü–∞—É–∑–∞
window.tgsManager.pauseAnimation(playerId);

// –£–¥–∞–ª–µ–Ω–∏–µ
window.tgsManager.destroyPlayer(playerId);
```

## üîß API TGSAnimationManager

### –ú–µ—Ç–æ–¥—ã:

- `createPlayer(containerId, giftNumber, options)` - –°–æ–∑–¥–∞—Ç—å –ø–ª–µ–µ—Ä
- `playAnimation(playerId)` - –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é
- `pauseAnimation(playerId)` - –ü–æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ –ø–∞—É–∑—É
- `destroyPlayer(playerId)` - –£–¥–∞–ª–∏—Ç—å –ø–ª–µ–µ—Ä
- `destroyAll()` - –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø–ª–µ–µ—Ä—ã
- `initAllOnPage()` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ TGS —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

### –û–ø—Ü–∏–∏:

```javascript
{
    autoplay: false,  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–∞—Ä—Ç
    loop: true,       // –ó–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–µ
    mode: 'normal',   // –†–µ–∂–∏–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
    style: {          // CSS —Å—Ç–∏–ª–∏
        width: '100%',
        height: '100%'
    }
}
```

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –í –∫–∞—Ä—É—Å–µ–ª–∏ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞

```javascript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏! –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ gift_number
response.items.forEach((item, index) => {
    const itemEl = document.createElement('div');
    itemEl.className = 'preview-item';
    
    const tgsId = `preview_tgs_${index}`;
    itemEl.innerHTML = `
        <div class="tgs-container" 
             id="${tgsId}" 
             data-gift-number="${item.gift.gift_number}"
             style="width: 60px; height: 60px;">
            <div class="tgs-loading">‚è≥</div>
        </div>
    `;
    
    container.appendChild(itemEl);
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
window.tgsManager.initAllOnPage();
```

### –ü—Ä–∏–º–µ—Ä 2: –í –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ

```javascript
if (item.gift.gift_number >= 1 && item.gift.gift_number <= 120) {
    const tgsId = `inventory_tgs_${index}`;
    itemImageContent = `
        <div class="tgs-container" 
             id="${tgsId}" 
             data-gift-number="${item.gift.gift_number}"
             style="width: 100px; height: 100px;">
            <div class="tgs-loading">‚è≥</div>
        </div>
    `;
} else {
    // Fallback –Ω–∞ –æ–±—ã—á–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    itemImageContent = `<img src="${item.gift.image_url}">`;
}
```

## üêõ Troubleshooting

### –ê–Ω–∏–º–∞—Ü–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è?

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: `/static/images/gift_limited_X.tgs`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `gift_number` –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 1-120
3. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –æ—à–∏–±–æ–∫

### FPS –ø–∞–¥–∞–µ—Ç?

1. –£–º–µ–Ω—å—à–∏—Ç–µ `maxVisibleAnimations` –≤ `tgs-manager.js`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏–∏ –ø–∞—É–∑—è—Ç—Å—è –≤–Ω–µ —ç–∫—Ä–∞–Ω–∞
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å—Ç–∞—Ä—ã–µ –ø–ª–µ–µ—Ä—ã —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ —ç–∫—Ä–∞–Ω–∞

### Fallback –Ω–∞ PNG/SVG

–ï—Å–ª–∏ TGS –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
```html
<div class="tgs-fallback">üéÅ</div>
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ gifts:

```sql
CREATE TABLE gifts (
    id INTEGER PRIMARY KEY,
    name TEXT NOT NULL,
    gift_number INTEGER,  -- –ù–æ–≤–æ–µ –ø–æ–ª–µ! –û—Ç 1 –¥–æ 120
    value INTEGER,
    rarity TEXT,
    image_url TEXT  -- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback
);
```

### –ü—Ä–∏–º–µ—Ä SQL:

```sql
INSERT INTO gifts (name, gift_number, value, rarity) VALUES
('Rare Bird', 1, 50, 'rare'),
('Artisan Brick', 2, 100, 'epic'),
('Victory Medal', 3, 150, 'legendary');
```

## üé® CSS –∫–ª–∞—Å—Å—ã

```css
.tgs-container     /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
.tgs-canvas        /* Canvas –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ */
.tgs-loading       /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ */
.tgs-fallback      /* Fallback –µ—Å–ª–∏ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å */
```

## ‚úÖ Checklist –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- [ ] –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –≤ HTML
- [ ] `tgs-manager.js` –ø–æ–¥–∫–ª—é—á–µ–Ω
- [ ] TGS —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ `/static/images/`
- [ ] –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `gift_number` –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω—ã –æ–±—ä–µ–∫—Ç—ã –ø–æ–¥–∞—Ä–∫–æ–≤ —Å `gift_number`
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω FPS –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏—è—Ö

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–¢–µ—Å—Ç—ã:**
- 10 –∞–Ω–∏–º–∞—Ü–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ: 60 FPS ‚úÖ
- 20 –∞–Ω–∏–º–∞—Ü–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ: 45-55 FPS ‚ö†Ô∏è
- 30+ –∞–Ω–∏–º–∞—Ü–∏–π: <30 FPS ‚ùå

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–µ—Ä–∂–∏—Ç–µ `maxVisibleAnimations = 10`

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- TGS —Ñ–∞–π–ª—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º
- –ê–Ω–∏–º–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–∞—É–∑—è—Ç—Å—è –≤–Ω–µ —ç–∫—Ä–∞–Ω–∞
- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS –∏ Android
- –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å Telegram Mini Apps

–ì–æ—Ç–æ–≤–æ! üéâ
